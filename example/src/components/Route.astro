---
// uri: column/article/8217

import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro'
// import OpenAPIParser from '@readme/openapi-parser'
// import type { InferGetStaticPropsType } from 'astro'

// import { getPageProps } from '../libs/starlight'

// import Operation from './operation/Operation.astro'
// import Overview from './Overview.astro'
import { getArticle, getIntro } from '@/lib/api'
import { dataMap } from '@/lib/convert'

export const prerender = false

// export function getStaticPaths() {
//   return getSchemaStaticPaths()
// }

// type Props = InferGetStaticPropsType<typeof getStaticPaths>


const { schema } = Astro.props

// schema.document = await OpenAPIParser.dereference(schema.document)

// const isOverview = type === 'overview'

// const title = isOverview ? 'Overview' : Astro.props.operation.title;
const title =  'Overview' ;
// console.log(Astro.props) // {}


const { slug } = Astro.params;

const { articles } = await getArticle(slug);
if (!articles || articles.length !== 1) return Astro.redirect("/404");

const article = articles[0].flatData;

const frontmatter = { title: article.name! };


const column = "hotel-directory";

const { intros } = await getIntro(column);

if (!intros || intros.length !== 1) return [];

const chapters = intros[0].flatData.chapters!;

const sidebar = dataMap(chapters);

---

<StarlightPage frontmatter={frontmatter} sidebar={sidebar}>
  <!-- {isOverview ? <Overview {schema} /> : <Operation {schema} operation={Astro.props.operation} />} -->
  <!-- <Overview {schema} /> -->
   <article set:html={article.content} />
</StarlightPage>
